worker_processes  1;

events {
    worker_connections  1024;
}

http {
    include       mime.types;
    default_type  application/octet-stream;

    sendfile        on;

    keepalive_timeout  65;

	server {
	    listen 80;
		
		pagespeed on;
		pagespeed FileCachePath /var/ngx_pagespeed_cache;  # Use tmpfs for best results

		#  Ensure requests for pagespeed optimized resources go to the pagespeed
		#  handler and no extraneous headers get set.
		location ~ "\.pagespeed\.([a-z]\.)?[a-z]{2}\.[^.]{10}\.[^.]+" { add_header "" ""; }
		location ~ "^/pagespeed_static/" { }
		location ~ "^/ngx_pagespeed_beacon$" { }

	    location / {
	        proxy_pass http://127.0.0.1:8080;
	        proxy_read_timeout 600s;
	        proxy_buffering off;
	        proxy_set_header Connection '';
	        proxy_http_version 1.1;
	        chunked_transfer_encoding off;
	    }
	}
}

daemon off;